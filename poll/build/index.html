<!DOCTYPE html>
<html>
  <head>
    <title>Polling example</title>
    <style type = "text/css">
      a {color: #151b8d; text-decoration:none; font-size: 110%; font-weight: bold;}
      a:visited {color: #151b8d;}
      a:hover {color: #fff; background-color: #666;}
    </style>
  </head>
  
  <body>
    <h2 style = 'color: #b00000'>Ajax-based polling test</h2>
    <p>
      <textarea id = 'textarea' rows = '2' cols = '16' 
		style = 'background-color: #66ffff;font-weight: bold; font-size: 125%;'>
      </textarea>
      <hr/>
      <p>
	<table>
	  <tr><td><a href = 'http://localhost:8080/jayson/service.jsp?inc'>Increment</a></td></tr>
	  <tr><td><a href = 'http://localhost:8080/jayson/service.jsp?dec'>Decrement</a></td></tr>
	  <tr><td><a href = 'http://localhost:8080/jayson/service.jsp?inc'>Reset</a></td></tr>
	</table>
      </p>
    </p>
  </body>
  <script type = "text/javascript" 
	  src = "http://code.jquery.com/jquery-latest.min.js">
  </script>

  <script type = "text/javascript">
    // The function sends a GET request to the resource, service.jsp,
    // that returns the current value of a counter, which is displayed
    // in the HTML textarea.
    var _poll = function() {
      $.getJSON('http://localhost:8080/jayson/service.jsp', function(response) {
        var counter = response.counter
        $('textarea').text(counter);
        _poll();
      });
    }
      
    // Invoked after the browser generates the DOM.
    // The body of this function invokes _poll(), defined above,
    // which polls the server for any new data, updates the textarea, 
    // and so on indefinitely.
    $.getJSON('http://localhost:8080/jayson/service.jsp', function(response) {
       var counter = response.counter;
       $('textarea').text(counter);
       _poll();
    });
  </script>
</html>

